/*! Midcentury Icons v1.0.0 | (c) Tim Dolan | CC BY-NC-SA 4.0 */

const ICONS = {
  "arco-lamp": {
    path: "M10.289 0.943C5.881 1.316 2.269 4.884 1.784 9.338C1.751 9.636 1.734 12.088 1.734 16.452L1.734 23.110 3.621 23.098L5.508 23.086 5.520 19.535L5.531 15.984 3.841 15.984L2.151 15.984 2.170 12.621C2.191 9.099 2.190 9.121 2.409 8.203C2.971 5.847 4.553 3.757 6.714 2.518C10.918 0.107 16.262 1.481 18.822 5.633L19.028 5.967 18.690 6.081C17.310 6.546 16.547 7.960 16.913 9.375L16.992 9.680 19.528 9.692L22.063 9.704 22.114 9.528C22.622 7.791 21.396 5.953 19.730 5.953L19.512 5.953 19.249 5.514C17.379 2.379 13.952 0.631 10.289 0.943M20.520 6.590C21.472 7.048 22.095 8.355 21.768 9.207C21.743 9.273 21.503 9.281 19.524 9.281L17.309 9.281 17.279 9.135C16.907 7.276 18.821 5.773 20.520 6.590M5.109 19.547L5.109 22.688 3.633 22.688L2.156 22.688 2.156 19.547L2.156 16.406 3.633 16.406L5.109 16.406 5.109 19.547M3.707 17.608C3.482 17.894 3.664 18.248 4.022 18.225C4.539 18.191 4.506 17.484 3.988 17.484C3.845 17.484 3.782 17.512 3.707 17.608"
  },
  "ceiling-globe": {
    // Fixture/canopy - this part animates with light state (yellow when on, gray when off)
    path: "M655.369 310.15C655.547 317.949 658.106 335.21 655.369 342.519C650.823 354.658 643.61 360.224 633.916 368.858C624.116 377.586 610.516 386.917 598.816 392.885C632.877 400.742 667.523 406.411 701.001 416.458C726.067 423.98 750.157 434.564 773.952 445.441C791.192 453.322 808.715 461.285 823.886 472.63C852.599 494.103 878.973 518.602 904.887 543.36C913.929 551.999 920.577 561.149 926.857 571.948C929.096 575.797 929.835 591.867 929.583 596.234C921.899 596.234 868.049 596.234 858.825 596.234L850.636 596.234L740.86 596.234C740.86 580.061 739.859 584.771 740.86 568.323C497.784 566.33 496.794 568.323 255.709 568.323C256.209 584.272 255.209 580.285 255.709 596.234C214.567 595.206 173.887 596.234 132.283 596.234C109.964 596.234 75.9838 596.234 49.537 596.234C53.8299 586.673 69.3839 557.164 75.9838 549.011C88.4795 533.576 104.112 520.87 119.394 508.166C136.801 493.696 154.088 478.626 173.887 467.625C211.253 446.864 249.416 426.541 290.089 413.324C324.709 402.074 361.865 401.027 397.753 394.879C397.753 379.98 372.664 378.522 361.285 368.858C354.854 363.396 350.445 355.465 347.799 347.468C345.036 339.117 343.25 329.685 345.514 321.186C346.925 315.89 352.358 311.269 357.741 310.15C390.366 303.366 423.66 298.807 456.978 298.011C507.286 296.807 548.779 292.672 598.816 298.011C615.172 299.756 639.697 305.166 655.369 310.15Z",
    // Globe/diffuser - stays fixed/black
    secondaryPath: "M223.109 547.802C223.109 454.893 349.254 547.802 504.861 547.802C660.468 547.802 786.613 454.893 786.613 547.802C786.613 640.71 660.468 716.027 504.861 716.027C349.254 716.027 223.109 640.71 223.109 547.802Z",
    viewBox: "0 0 1024 1024"
  },
  "nelson-saucer": {
    path: "M517.192 195.507C511.367 195.507 511.367 195.507 505.543 195.507C505.543 226.436 507.437 257.441 505.543 288.295C504.182 310.459 503.357 333.53 495.812 354.022C491.249 366.413 482.168 378.861 470.824 382.587C428.535 396.477 383.524 395.844 340.268 405.109C279.821 418.055 205.057 436.545 146.188 465.017C120.817 477.289 95.8497 491.002 72.3331 507.373C38.8209 530.701 3.82847 567.701 9.71793 617.404C14.8398 660.628 56.4731 698.167 87.9414 715.37C124.983 735.619 162.697 754.897 201.932 768.806C250.71 786.098 300.771 798.966 351.144 808.676C404.11 818.886 457.65 829.196 511.367 828.456C571.072 827.632 630.342 815.435 689.202 804.016C735.118 795.107 780.727 783.258 825.217 767.563C861.207 754.867 895.84 737.375 929.924 719.098C962.326 701.724 1005.95 662.813 1013.74 619.682C1022.24 572.667 983.581 527.227 951.858 506.182C906.455 476.062 848.572 449.972 797.504 434.105C762.179 423.13 726.496 413.436 690.476 405.937C650.726 397.663 610.17 395.081 570.417 386.833C542.457 381.032 521.989 354.391 519.551 321.964C516.393 279.956 517.978 237.659 517.192 195.507Z",
    viewBox: "0 0 1024 1024"
  },
  "nesso-lamp": {
    path: "M801.767 474.898C651.072 474.898 653.396 474.644 500.036 473.666C507.011 542.331 508.655 612.961 520.846 680.894C523.408 695.167 531.812 709.485 543.548 718.002C555.007 726.318 571.16 724.285 584.966 727.426C584.966 742.427 584.966 742.427 584.966 757.428C498.187 757.893 411.406 756.848 324.627 756.339C324.627 742.317 324.627 742.317 324.627 728.294C337.522 726.16 352.852 729.729 363.313 721.892C378.183 710.752 391.068 694.04 394.681 675.814C407.753 609.869 409.329 542.161 412.274 474.644C258.418 474.644 259.51 474.898 105.244 474.898C111.703 439.169 107.993 384.457 124.621 352.181C141.276 319.852 169.291 292.289 200.733 274.015C231.482 256.145 268.868 252.187 304.166 247.834C365.534 240.265 427.595 237.972 489.427 238.41C538.981 238.761 589.138 239.963 637.625 250.197C671.354 257.316 705.206 269.646 733.138 289.849C757.989 307.823 779.069 333.068 791.166 361.251C804.222 391.669 796.843 442.164 801.767 474.898Z",
    viewBox: "-60 -15 1024 1024"
  }
};

// Default viewBox for icons that don't specify one
const DEFAULT_VIEWBOX = "0 0 24 24";

// Icon getter function for Home Assistant
async function getIcon(name) {
  if (!(name in ICONS)) {
    console.warn(`Midcentury Icons: Unknown icon mci:${name}`);
    return null;
  }

  const icon = ICONS[name];
  
  // Support both old format (string) and new format (object with path/viewBox/secondaryPath)
  if (typeof icon === "string") {
    return {
      path: icon,
      viewBox: DEFAULT_VIEWBOX
    };
  }

  const result = {
    path: icon.path,
    viewBox: icon.viewBox || DEFAULT_VIEWBOX
  };

  // Include secondaryPath if present (for dual-color icons)
  // secondaryPath stays fixed color, path animates with entity state
  if (icon.secondaryPath) {
    result.secondaryPath = icon.secondaryPath;
  }

  return result;
}

// Get list of all available icons (for icon picker support)
async function getIconList() {
  return Object.keys(ICONS).map(icon => ({
    name: icon
  }));
}

// Register the iconset with Home Assistant
window.customIconsets = window.customIconsets || {};
window.customIconsets["mci"] = getIcon;

// Register icon list for icon picker (if supported)
if (window.customIcons) {
  window.customIcons = window.customIcons || {};
  window.customIcons["mci"] = { getIcon, getIconList };
}

// Dispatch event to notify Home Assistant that icons are loaded
window.dispatchEvent(new CustomEvent("iconset-loaded", { detail: "mci" }));

// Log successful load
console.info(
  `%c MIDCENTURY-ICONS %c v1.0.0 loaded with ${Object.keys(ICONS).length} icons `,
  "color: white; background: #44739e; font-weight: 700;",
  "color: #44739e; background: white; font-weight: 700;"
);
